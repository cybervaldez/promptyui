<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empty Job + Add Prompt — Preview</title>
<style>
/* ── Design Tokens (from PromptyUI styles.css) ── */
:root {
    --pu-bg-primary: #191919;
    --pu-bg-secondary: #202020;
    --pu-bg-tertiary: #2f2f2f;
    --pu-bg-input: #252525;
    --pu-bg-hover: rgba(255, 255, 255, 0.04);
    --pu-bg-selected: rgba(255, 255, 255, 0.06);
    --pu-bg-elevated: #252525;
    --pu-bg-overlay: rgba(0, 0, 0, 0.5);

    --pu-text-primary: #ebebeb;
    --pu-text-secondary: #999999;
    --pu-text-muted: #7a7a7a;

    --pu-accent: #529CCA;
    --pu-accent-bg: rgba(82, 156, 202, 0.08);
    --pu-accent-light: rgba(82, 156, 202, 0.12);
    --pu-accent-border: rgba(82, 156, 202, 0.25);
    --pu-success: #4daa57;
    --pu-warning: #cb912f;
    --pu-error: #e06c75;

    --pu-border: rgba(255, 255, 255, 0.06);
    --pu-border-light: rgba(255, 255, 255, 0.09);

    --pu-radius-sm: 3px;
    --pu-radius: 4px;
    --pu-radius-lg: 6px;
    --pu-radius-full: 9999px;

    --pu-font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --pu-font-mono: 'JetBrains Mono', 'SF Mono', 'Consolas', monospace;
    --pu-font-size-2xs: 10px;
    --pu-font-size-xs: 11px;
    --pu-font-size-sm: 12px;
    --pu-font-size-md: 13px;
    --pu-font-size-base: 14px;
    --pu-font-size-lg: 16px;

    --pu-space-xs: 4px;
    --pu-space-sm: 8px;
    --pu-space-md: 12px;
    --pu-space-lg: 16px;
    --pu-space-xl: 24px;

    --pu-transition-fast: 120ms ease-out;
    --pu-transition-normal: 200ms ease-out;
    --pu-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    --pu-shadow-lg: 0 6px 20px rgba(0, 0, 0, 0.4);
}

* { box-sizing: border-box; }
body {
    margin: 0;
    padding: 0;
    font-family: var(--pu-font-body);
    font-size: var(--pu-font-size-base);
    line-height: 1.5;
    background: var(--pu-bg-primary);
    color: var(--pu-text-primary);
}

/* ── Scenario Switcher ── */
.preview-controls {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 3000;
    background: var(--pu-bg-secondary);
    border-bottom: 1px solid var(--pu-border-light);
    padding: var(--pu-space-sm) var(--pu-space-lg);
    display: flex;
    align-items: center;
    gap: var(--pu-space-lg);
    font-size: var(--pu-font-size-sm);
    color: var(--pu-text-secondary);
}
.preview-controls label { cursor: pointer; display: flex; align-items: center; gap: 4px; }
.preview-controls input[type="radio"] { accent-color: var(--pu-accent); }
.preview-label {
    font-family: var(--pu-font-mono);
    color: var(--pu-accent);
    font-size: var(--pu-font-size-xs);
    background: var(--pu-accent-bg);
    padding: 2px 6px;
    border-radius: var(--pu-radius-sm);
    margin-right: var(--pu-space-sm);
}

.scenario { display: none; margin-top: 40px; height: calc(100vh - 40px); }
.scenario.active { display: flex; }

/* ── 3-Panel Layout ── */
.pu-layout {
    display: flex;
    width: 100%;
    height: 100%;
}

/* ── Sidebar ── */
.pu-sidebar {
    width: 240px;
    background: var(--pu-bg-secondary);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    border-right: 1px solid var(--pu-border);
}
.pu-sidebar-header {
    display: flex;
    align-items: center;
    gap: var(--pu-space-sm);
    padding: var(--pu-space-md);
    background: var(--pu-bg-hover);
    cursor: pointer;
    user-select: none;
}
.pu-sidebar-title {
    font-size: var(--pu-font-size-xs);
    font-weight: 400;
    text-transform: capitalize;
    color: var(--pu-text-muted);
    flex: 1;
}
.pu-sidebar-toggle {
    font-size: var(--pu-font-size-2xs);
    color: var(--pu-text-muted);
}
.pu-sidebar-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--pu-space-xs) 0;
}
.pu-sidebar-footer {
    padding: var(--pu-space-sm);
    border-top: 1px solid var(--pu-border);
}
.pu-jobs-count {
    font-size: var(--pu-font-size-xs);
    color: var(--pu-text-secondary);
    background: var(--pu-bg-primary);
    padding: 2px 6px;
    border-radius: var(--pu-radius-full);
}

/* Tree Items */
.pu-tree-item {
    display: flex;
    align-items: center;
    padding: 6px var(--pu-space-sm);
    margin: 0 var(--pu-space-xs);
    border-radius: var(--pu-radius);
    cursor: pointer;
    user-select: none;
    transition: background var(--pu-transition-fast);
}
.pu-tree-item:hover { background: var(--pu-bg-hover); }
.pu-tree-item.active {
    background: var(--pu-bg-tertiary);
    border-left: 3px solid var(--pu-accent);
    margin-left: var(--pu-space-xs);
    padding-left: 5px;
}
.pu-tree-toggle {
    font-size: var(--pu-font-size-2xs);
    color: var(--pu-text-muted);
    margin-right: 6px;
    width: 12px;
    text-align: center;
}
.pu-tree-label {
    flex: 1;
    font-size: var(--pu-font-size-md);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.pu-tree-badge {
    font-size: var(--pu-font-size-xs);
    color: var(--pu-text-muted);
    background: var(--pu-bg-primary);
    padding: 1px 5px;
    border-radius: var(--pu-radius-full);
    margin-left: 6px;
}
.pu-tree-children { padding-left: var(--pu-space-lg); }
.pu-tree-children .pu-tree-item { padding-left: var(--pu-space-sm); }

/* ── Buttons ── */
.pu-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: var(--pu-space-sm) var(--pu-space-lg);
    background: var(--pu-bg-hover);
    border: 1px solid var(--pu-border);
    border-radius: var(--pu-radius);
    color: var(--pu-text-primary);
    font-family: var(--pu-font-body);
    font-size: var(--pu-font-size-sm);
    cursor: pointer;
    transition: all var(--pu-transition-fast);
}
.pu-btn:hover {
    background: var(--pu-bg-selected);
    border-color: var(--pu-border-light);
}
.pu-btn-primary {
    background: var(--pu-accent);
    border-color: var(--pu-accent);
    color: #fff;
    font-weight: 500;
}
.pu-btn-primary:hover {
    background: #4a8ab5;
    border-color: #4a8ab5;
}
.pu-btn-full { width: 100%; }
.pu-btn-ghost {
    background: transparent;
    border: 1px dashed var(--pu-border-light);
    color: var(--pu-text-muted);
}
.pu-btn-ghost:hover {
    border-color: var(--pu-accent-border);
    color: var(--pu-accent);
    background: var(--pu-accent-bg);
}

/* ── Center Editor ── */
.pu-editor {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: var(--pu-bg-primary);
}
.pu-editor-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
    color: var(--pu-text-secondary);
}
.pu-editor-empty-icon {
    font-size: 48px;
    opacity: 0.3;
    margin-bottom: var(--pu-space-lg);
}
.pu-editor-empty h2 {
    margin: 0 0 var(--pu-space-sm);
    color: var(--pu-text-primary);
    font-size: 18px;
    font-weight: 500;
}
.pu-editor-empty p {
    margin: 0 0 var(--pu-space-xl);
    max-width: 320px;
    line-height: 1.6;
}
.pu-editor-empty-actions {
    display: flex;
    gap: var(--pu-space-md);
}

/* Defaults toolbar */
.pu-defaults-toolbar {
    padding: var(--pu-space-sm) var(--pu-space-lg);
    border-bottom: 1px solid var(--pu-border);
    background: var(--pu-bg-secondary);
}
.pu-defaults-header {
    display: flex;
    align-items: center;
    gap: var(--pu-space-sm);
    font-size: var(--pu-font-size-xs);
    color: var(--pu-text-muted);
    text-transform: uppercase;
}
.pu-defaults-hint {
    font-size: var(--pu-font-size-xs);
    color: var(--pu-text-muted);
    font-style: italic;
    text-transform: none;
}

/* Prompt header */
.pu-prompt-header {
    display: flex;
    align-items: center;
    gap: var(--pu-space-sm);
    padding: var(--pu-space-sm) var(--pu-space-lg);
    border-bottom: 1px solid var(--pu-border);
}
.pu-prompt-label {
    font-size: var(--pu-font-size-xs);
    color: var(--pu-text-muted);
    text-transform: uppercase;
}
.pu-prompt-title {
    font-size: var(--pu-font-size-base);
    color: var(--pu-text-primary);
    font-weight: 500;
}

/* Content blocks */
.pu-blocks-container {
    flex: 1;
    overflow-y: auto;
    padding: var(--pu-space-lg);
}
.pu-block {
    background: var(--pu-bg-secondary);
    border: 1px solid var(--pu-border);
    border-radius: var(--pu-radius);
    padding: var(--pu-space-md) var(--pu-space-lg);
    margin-bottom: var(--pu-space-sm);
    font-size: var(--pu-font-size-md);
    cursor: pointer;
    transition: border-color var(--pu-transition-fast);
}
.pu-block:hover { border-color: var(--pu-border-light); }
.pu-block .pu-wc-highlight {
    color: var(--pu-warning);
    font-family: var(--pu-font-mono);
}

/* Add block area */
.pu-add-block-area {
    padding: var(--pu-space-sm) var(--pu-space-lg) var(--pu-space-lg);
}

/* ── Right Panel ── */
.pu-right-panel {
    width: 260px;
    background: var(--pu-bg-secondary);
    display: flex;
    flex-direction: column;
    flex-shrink: 0;
    border-left: 1px solid var(--pu-border);
}
.pu-rp-note {
    font-size: var(--pu-font-size-sm);
    color: var(--pu-text-secondary);
    padding: 12px;
    background: var(--pu-bg-primary);
    border-radius: var(--pu-radius);
    border: 1px solid var(--pu-border);
    line-height: 1.6;
    margin: var(--pu-space-sm);
}

/* ── Empty-prompt CTA in center panel ── */
.pu-empty-prompt-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
    text-align: center;
    color: var(--pu-text-secondary);
    padding: var(--pu-space-xl);
}
.pu-empty-prompt-cta .pu-cta-icon {
    font-size: 40px;
    opacity: 0.25;
    margin-bottom: var(--pu-space-lg);
}
.pu-empty-prompt-cta h3 {
    margin: 0 0 var(--pu-space-sm);
    color: var(--pu-text-primary);
    font-weight: 500;
    font-size: 16px;
}
.pu-empty-prompt-cta p {
    margin: 0 0 var(--pu-space-xl);
    max-width: 300px;
    font-size: var(--pu-font-size-sm);
    line-height: 1.6;
}

/* ── Annotation overlays ── */
.annotation {
    position: absolute;
    pointer-events: none;
    z-index: 100;
}
.annotation-arrow {
    font-size: var(--pu-font-size-sm);
    color: var(--pu-accent);
    font-family: var(--pu-font-mono);
}
.callout {
    background: var(--pu-accent-bg);
    border: 1px solid var(--pu-accent-border);
    border-radius: var(--pu-radius);
    padding: 6px 10px;
    font-size: var(--pu-font-size-xs);
    color: var(--pu-accent);
    margin-top: var(--pu-space-lg);
    max-width: 280px;
    line-height: 1.5;
}
</style>
</head>
<body>

<!-- Scenario Switcher -->
<div class="preview-controls">
    <span class="preview-label">GAP 1</span>
    <label><input type="radio" name="scene" value="a" checked onchange="switchScene('a')"> A: Zero prompts — center CTA</label>
    <label><input type="radio" name="scene" value="b" onchange="switchScene('b')"> B: Sidebar + Add Prompt button</label>
    <label><input type="radio" name="scene" value="c" onchange="switchScene('c')"> C: After adding first prompt</label>
</div>

<!-- ════════════════════════════════════════════════════════════════ -->
<!-- SCENARIO A: Zero prompts — center panel CTA                     -->
<!-- ════════════════════════════════════════════════════════════════ -->
<div class="scenario active" id="scene-a" data-testid="scene-zero-prompts">
    <div class="pu-layout">
        <!-- Sidebar -->
        <div class="pu-sidebar">
            <div class="pu-sidebar-header">
                <span class="pu-sidebar-title">JOBS</span>
                <span class="pu-jobs-count">1</span>
                <span class="pu-sidebar-toggle">&#9660;</span>
            </div>
            <div class="pu-sidebar-content">
                <div class="pu-tree-item active">
                    <span class="pu-tree-toggle">&#9660;</span>
                    <span class="pu-tree-label">my-emails</span>
                </div>
                <div class="pu-tree-children">
                    <div class="pu-tree-item" style="opacity: 0.5;">
                        <span class="pu-tree-toggle" style="visibility:hidden;">&#9654;</span>
                        <span class="pu-tree-label" style="color: var(--pu-text-muted); font-style: italic; font-size: var(--pu-font-size-sm);">No prompts</span>
                    </div>
                    <!-- NEW: Add Prompt ghost button in sidebar -->
                    <div style="padding: 4px var(--pu-space-sm);">
                        <button class="pu-btn pu-btn-ghost pu-btn-full" data-testid="pu-add-prompt-btn" style="font-size: var(--pu-font-size-xs); padding: 5px 8px;">
                            + Add Prompt
                        </button>
                    </div>
                </div>
                <div class="pu-tree-item">
                    <span class="pu-tree-toggle" style="visibility:hidden;">&#9654;</span>
                    <span class="pu-tree-label" style="color: var(--pu-text-muted);">Defaults</span>
                </div>
            </div>
            <div class="pu-sidebar-footer">
                <button class="pu-btn pu-btn-full">+ New Job</button>
            </div>
        </div>

        <!-- Center: Empty prompt state -->
        <div class="pu-editor">
            <div class="pu-defaults-toolbar">
                <div class="pu-defaults-header">
                    <span>DEFAULTS</span>
                    <span class="pu-defaults-hint">(applies to all prompts)</span>
                </div>
            </div>

            <div class="pu-empty-prompt-cta" data-testid="pu-empty-prompt-cta">
                <div class="pu-cta-icon">&#9997;</div>
                <h3>This job has no prompts yet</h3>
                <p>A prompt is a text template with wildcard variables like <code style="color: var(--pu-warning); font-family: var(--pu-font-mono); font-size: var(--pu-font-size-sm);">__tone__</code> that expand into many variations.</p>
                <button class="pu-btn pu-btn-primary" data-testid="pu-add-first-prompt-btn">+ Add Your First Prompt</button>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="pu-right-panel">
            <div style="padding: var(--pu-space-sm);">
                <div class="pu-rp-note">Select a prompt to see wildcards</div>
            </div>
        </div>
    </div>
</div>

<!-- ════════════════════════════════════════════════════════════════ -->
<!-- SCENARIO B: Sidebar with Add Prompt button (job has 1 prompt)   -->
<!-- ════════════════════════════════════════════════════════════════ -->
<div class="scenario" id="scene-b" data-testid="scene-sidebar-add-prompt">
    <div class="pu-layout">
        <!-- Sidebar -->
        <div class="pu-sidebar">
            <div class="pu-sidebar-header">
                <span class="pu-sidebar-title">JOBS</span>
                <span class="pu-jobs-count">1</span>
                <span class="pu-sidebar-toggle">&#9660;</span>
            </div>
            <div class="pu-sidebar-content">
                <div class="pu-tree-item active">
                    <span class="pu-tree-toggle">&#9660;</span>
                    <span class="pu-tree-label">my-emails</span>
                </div>
                <div class="pu-tree-children">
                    <div class="pu-tree-item">
                        <span class="pu-tree-toggle" style="visibility:hidden;">&#9654;</span>
                        <span class="pu-tree-label">Prompts</span>
                        <span class="pu-tree-badge">1</span>
                    </div>
                    <div class="pu-tree-children">
                        <div class="pu-tree-item active">
                            <span class="pu-tree-toggle" style="visibility:hidden;">&#9654;</span>
                            <span class="pu-tree-label">welcome-email</span>
                        </div>
                    </div>
                    <!-- NEW: Add Prompt ghost button after prompt list -->
                    <div style="padding: 4px var(--pu-space-sm);">
                        <button class="pu-btn pu-btn-ghost pu-btn-full" data-testid="pu-add-prompt-btn" style="font-size: var(--pu-font-size-xs); padding: 5px 8px;">
                            + Add Prompt
                        </button>
                    </div>
                    <div class="pu-tree-item">
                        <span class="pu-tree-toggle" style="visibility:hidden;">&#9654;</span>
                        <span class="pu-tree-label" style="color: var(--pu-text-muted);">Defaults</span>
                    </div>
                </div>
            </div>
            <div class="pu-sidebar-footer">
                <button class="pu-btn pu-btn-full">+ New Job</button>
            </div>
        </div>

        <!-- Center: Prompt selected, has one block -->
        <div class="pu-editor">
            <div class="pu-defaults-toolbar">
                <div class="pu-defaults-header">
                    <span>DEFAULTS</span>
                    <span class="pu-defaults-hint">(applies to all prompts)</span>
                </div>
            </div>
            <div class="pu-prompt-header">
                <span class="pu-prompt-label">PROMPT:</span>
                <span class="pu-prompt-title">welcome-email</span>
            </div>
            <div class="pu-blocks-container">
                <div class="pu-block">
                    Write a <span class="pu-wc-highlight">__tone__</span> welcome email for new <span class="pu-wc-highlight">__role__</span> hires
                </div>
            </div>
            <div class="pu-add-block-area">
                <button class="pu-btn" style="font-size: var(--pu-font-size-sm);">+ Add Root Block &#9660;</button>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="pu-right-panel">
            <div style="padding: var(--pu-space-sm);">
                <div class="pu-rp-note">
                    No wildcards or themes yet. The panel shows the composition navigator once wildcards are added.
                </div>
            </div>
        </div>
    </div>

    <div class="callout" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);">
        Note the dashed <strong>+ Add Prompt</strong> ghost button in the sidebar — always visible below the prompt list for adding subsequent prompts.
    </div>
</div>

<!-- ════════════════════════════════════════════════════════════════ -->
<!-- SCENARIO C: After adding first prompt (focus overlay opens)     -->
<!-- ════════════════════════════════════════════════════════════════ -->
<div class="scenario" id="scene-c" data-testid="scene-after-add-prompt">
    <div class="pu-layout" style="filter: blur(2px); opacity: 0.4;">
        <div class="pu-sidebar" style="width: 240px; background: var(--pu-bg-secondary);"></div>
        <div class="pu-editor" style="flex:1; background: var(--pu-bg-primary);"></div>
        <div class="pu-right-panel" style="width: 260px; background: var(--pu-bg-secondary);"></div>
    </div>

    <!-- Focus overlay -->
    <div style="position: fixed; top: 40px; left: 0; right: 0; bottom: 0; background: var(--pu-bg-overlay); display: flex; align-items: center; justify-content: center; z-index: 2000;">
        <div style="width: min(700px, 85vw); height: min(500px, 70vh); background: var(--pu-bg-elevated); border: 1px solid var(--pu-border); border-radius: var(--pu-radius-lg); box-shadow: var(--pu-shadow-lg); display: flex; flex-direction: column; overflow: hidden;" data-testid="pu-focus-panel">
            <!-- Header -->
            <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--pu-space-md) 20px; border-bottom: 1px solid var(--pu-border);">
                <div style="display: flex; align-items: center; gap: var(--pu-space-sm);">
                    <span style="font-size: var(--pu-font-size-sm); color: var(--pu-text-muted);">New prompt:</span>
                    <input type="text" value="welcome-email" style="background: var(--pu-bg-input); border: 1px solid var(--pu-border-light); border-radius: var(--pu-radius); padding: 4px 8px; color: var(--pu-text-primary); font-family: var(--pu-font-mono); font-size: var(--pu-font-size-sm); width: 180px;" data-testid="pu-new-prompt-id-input" placeholder="prompt-id">
                </div>
                <button style="background: none; border: none; color: var(--pu-text-muted); font-size: 20px; cursor: pointer; line-height: 1;">&times;</button>
            </div>

            <!-- Quill editor area -->
            <div style="flex: 1; padding: 20px; overflow-y: auto;">
                <div style="min-height: 200px; font-size: 15px; line-height: 1.8; color: var(--pu-text-primary); outline: none;" contenteditable="true" data-testid="pu-focus-quill">
                    Write a <span style="color: var(--pu-warning); font-family: var(--pu-font-mono);">__tone__</span> welcome email for new <span style="color: var(--pu-warning); font-family: var(--pu-font-mono);">__role__</span> hires
                </div>
            </div>

            <!-- Output footer -->
            <div style="border-top: 1px solid var(--pu-border); padding: var(--pu-space-sm) 20px; display: flex; align-items: center; gap: var(--pu-space-sm);">
                <span style="font-size: var(--pu-font-size-sm); color: var(--pu-text-muted);">Resolved Output</span>
                <span style="font-size: var(--pu-font-size-xs); color: var(--pu-text-muted); background: var(--pu-bg-primary); padding: 1px 5px; border-radius: var(--pu-radius-full);">0</span>
                <span style="flex:1;"></span>
                <span style="font-size: var(--pu-font-size-2xs); color: var(--pu-text-muted);">&#9660;</span>
            </div>
        </div>
    </div>

    <div class="callout" style="position: fixed; bottom: 20px; right: 20px; z-index: 3000;">
        The focus overlay opens with a prompt ID input at the top. The user types their text in the Quill editor. <code style="color: var(--pu-warning);">__wildcards__</code> highlight automatically.
    </div>
</div>

<script>
function switchScene(id) {
    document.querySelectorAll('.scenario').forEach(s => s.classList.remove('active'));
    document.getElementById('scene-' + id).classList.add('active');
}
</script>
</body>
</html>
